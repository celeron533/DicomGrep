<Window x:Class="DicomGrep.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DicomGrep"
        xmlns:vm="clr-namespace:DicomGrep.ViewModels"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        mc:Ignorable="d"
        Title="MainWindow" Height="640" Width="960" MinWidth="300" MinHeight="200">
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="16"/>
            <RowDefinition/>
            <RowDefinition Height="Auto" MinHeight="16"/>
        </Grid.RowDefinitions>
        <Menu MinHeight="20">
            <MenuItem Header="File">
                <MenuItem Header="Exit"/>
            </MenuItem>
        </Menu>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="30"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="3*" MinWidth="30"/>
            </Grid.ColumnDefinitions>
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch"/>
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="30"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*" MinHeight="30"/>
                </Grid.RowDefinitions>
                <DataGrid ItemsSource="{Binding MatchedFileList}" AutoGenerateColumns="False" SelectedItem="{Binding SelectedMatchedFile, Mode=OneWayToSource}" SelectionMode="Single">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="File" Binding="{Binding Filename, Mode=OneWay}"/>
                        <DataGridTextColumn Header="Patient" Binding="{Binding PatientName, Mode=OneWay}"/>
                        <DataGridTextColumn Header="SOP Class" Binding="{Binding SOPClassName, Mode=OneWay}"/>
                        <DataGridTextColumn Header="Matches" Binding="{Binding ResultDicomItems.Count}"/>
                        <DataGridTextColumn Header="SOP Class UID" Binding="{Binding SOPClassUID, Mode=OneWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch"/>
                <DataGrid Grid.Row="2" AutoGenerateColumns="False" ItemsSource="{Binding SelectedMatchedFile.ResultDicomItems}" SelectionMode="Single" >
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Tag" Binding="{Binding Tag, Mode=OneWay}"/>
                        <DataGridTextColumn Header="Name" Binding="{Binding Tag.DictionaryEntry.Name, Mode=OneWay}"/>
                        <DataGridTextColumn Header="Value" Binding="{Binding ValueString, Mode=OneWay}"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding Type, Mode=OneWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
            <StackPanel>
                <StackPanel>
                    <Label Content="Search Path"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox IsEditable="True" ItemsSource="{Binding SearchPathHistory}" Text="{Binding SearchPath}"/>
                        <Button Grid.Column="1" MinWidth="20" Content="..."/>
                    </Grid>
                    <Label Content="File Types"/>
                    <ComboBox IsEditable="True" ItemsSource="{Binding FileTypesHistory}" Text="{Binding FileTypes}"/>
                    <Label Content="Search Text"/>
                    <ComboBox IsEditable="True" ItemsSource="{Binding SearchTextHistory}" Text="{Binding SearchText}"/>
                    <Button Content="Search" Command="{Binding SearchCommand, Mode=OneWay}"/>
                    <Button Content="Cancel" Command="{Binding CancelCommand, Mode=OneWay}"/>
                </StackPanel>
                <StackPanel>
                    <CheckBox Content="Search DICOM tag" IsChecked="{Binding SearchDicomTag}"/>
                    <CheckBox Content="Search DICOM value" IsChecked="{Binding SearchDicomValue}"/>
                    <CheckBox Content="Case sensitive" IsChecked="{Binding CaseSensitive}"/>
                    <CheckBox Content="Whole word" IsChecked="{Binding WholeWord}"/>
                    <CheckBox Content="Include subfolders" IsChecked="{Binding IncludeSubfolders}"/>
                    <CheckBox Content="Include private tag" IsChecked="{Binding IncludePrivateTag}"/>
                </StackPanel>
            </StackPanel>
        </Grid>
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding MatchedFileCount}"/>
                    <TextBlock Text="/"/>
                    <TextBlock Text="{Binding SearchedFileCount}"/>
                    <TextBlock Text="/"/>
                    <TextBlock Text="{Binding TotalFileCount}"/>
                </StackPanel>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <Grid>
                    <ProgressBar Value="{Binding SearchedFileCount}" Maximum="{Binding TotalFileCount}" Background="{x:Null}"/>
                    <ProgressBar Value="{Binding MatchedFileCount}" Maximum="{Binding TotalFileCount}" Foreground="BlueViolet" Background="{x:Null}" />
                    <TextBlock Text="{Binding CurrentFile}" />
                </Grid>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
